<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
  <!-- This file was converted to xhtml by Writer2xhtml ver. 0.5. See http://www.hj-gym.dk/~hj/writer2latex for more info. -->
  <head profile="http://dublincore.org/documents/dcq-html/">
    <title>Tree Regression</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />
    <link href="http://purl.org/dc/elements/1.1/" rel="schema.DC" />
    <meta content="Tree Regression" name="DC.title" />
    <meta content="" name="DC.subject" />
    <meta content="" name="DC.description" />
    <meta content="" name="DC.creator" />
    <meta content="2008-07-02T09:52:27" name="DC.date" />
    <meta content="en-US" name="DC.language" />
    <link href="styles/caddis.css" media="all" rel="stylesheet" type="text/css" />
  </head>
  <body dir="ltr">
    <div id="TOC7Cregion">
      <div id="TableofContents1">
        <p class="ContentsHeading">Table of Contents</p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc0">Introduction</a>
        </p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc1">Tool Use</a>
        </p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc2">Example</a>
        </p>
        <p class="Contents1">
          <span class="SectionNumber"></span>
          <a href="#toc3"></a>
        </p>
      </div>
      <p class="Standard"></p>
    </div>
    <div id="MainContent7Cregion">
      <p class="Title">CADStat: Statistical Tools for Causal Analysis</p>
      <p class="Title">
        <a href="http://cfpub.epa.gov/caddis/analytical_tools.cfm?section=148&amp;step=22&amp;parent_section=143">Classification and regression trees</a>
      </p>
      <h1 id="toc0"><span class="SectionNumber"></span>Introduction</h1>
      <p>Recursive partitioning is a method used to analyze the relationship between a response and a collection of explanatory variables. In recursive partitioning algorithms, the data are split into groups such that cases within groups are most similar and the differences between groups are greatest. The splits are often called nodes and a collections of splits is referred to as a tree.</p>
      <p>The main advantage of using classification trees is the lack of corresponding assumptions about the underlying relationship between the response/dependent variable and the explanatory/independent variable. Additionally, there are no assumptions about the underlying distribution of the data or the residuals that result from the model fit. The focus of most regression tree modeling is prediction. If the response/dependent variable is continuous, then it is considered a regression problem. Alternatively, if the response/dependent variable is categorical, then it is considered a classification problem.</p>
      <h1 id="toc1"><span class="SectionNumber"></span>Tool Use</h1>
      <p>Select <i>Analysis Tools -&gt; Tree Regression</i> from the menus.  A dialog box will open.  Select the data set of interest from the pull-down menu, or browse for a tab-delimited text file.  The Data Subsetting tab can be used to select a subset of the data file by choosing a variable from the pull down menu and then selecting the levels of that variable to include.  You can hold down the &lt;CTRL&gt; key to add several different levels. </p>
      <p>Select a <b>Dependent </b>variable (the variable you wish to predict).</p>
      <p>Select all <b>Independent</b> variables you wish to include in the model (the variables used to predict the dependent variable).  You may hold down the &lt;CTRL&gt; key to several variables.  <i>Note</i>: the dependent variable is in the list of possible independent variables, but it <i>should not</i> be selected as an independent variable, or a degenerate regression will be produced.</p>
      <p>You can set further options for controlling the tree regression by setting the three analysis options.  They are explained briefly in the example below.</p>
      <p>The output is a graph containing the tree structure and its estimated regression coefficients.</p>
      <h1 id="toc2"><span class="SectionNumber"></span>Example</h1>
      <p>First launch the tree regression tool by selecting <i>Analysis Tools -&gt; Tree Regression</i>.</p>
      <p></p>
      <div style="text-align:center">
        <img alt="graphics1" class="frameGraphics" id="graphics17Cgraphics" src="rpart.JGR-img1.png" style="width:480.0px;height:216.0px" />
      </div>
      <p></p>
      <p>Once this option is selected, a new window will open with the available options for the tree regression analysis.</p>
      <p></p>
      <div style="text-align:center">
        <img alt="graphics4" class="frameGraphics" id="graphics47Cgraphics" src="rpart.JGR-img2.png" style="width:432.0px;height:384.0px" />
      </div>
      <p></p>
      <p>For this example, select <tt>mergedData</tt> as your active dataset (see help page on Loading and merging data for information on loading CADStat example data).  Then, select average stream temperature (<tt>temp.avg</tt>) as the response/dependent variable.  Hold down the &lt;CTRL&gt; key and select latitude, log catchment area, and elevation (<tt>lat, area, elev.ut</tt>) as explanatory variables.  The<i> </i><b>Min Split</b> variable specifies how many cases need to be in each split. As this number decreases, splits are more likely to be made. The <b>Min Bucket</b> variable specifies the minimum number of observations that must exist in any terminal node. The <b>CP</b> variable is a complexity parameter. As the value of this parameter is increased, the effective difference between groups that is needed for a split to occur increases as well. In an ANOVA context, the <b>CP</b> variable corresponds to the increase in the R2 needed to perform a split. With large dataset, increasing the <b>CP</b> variable decreases the computing time needed. In this example, it is left at the default 0.01.</p>
      <p>The text output sent to the CADStat console window gives the details of the model fit: </p>
      <p>Call:</p>
      <p>
        <tt>rpart(formula = as.formula(formula), data = my.data, minsplit = minsplit, </tt>
      </p>
      <p>
        <tt> minbucket = minbucket, cp = cp)</tt>
      </p>
      <p>
        <tt> n=125 (123 observations deleted due to missingness)</tt>
      </p>
      <p>
        <tt></tt>
      </p>
      <p>
        <tt> CP nsplit rel error  xerror  xstd</tt>
      </p>
      <p>
        <tt>1 0.35284747  0 1.0000000 1.0117763 0.11690690</tt>
      </p>
      <p>
        <tt>2 0.06556603  1 0.6471525 0.7750921 0.09581347</tt>
      </p>
      <p>
        <tt>3 0.05290123  3 0.5160205 0.8017522 0.10312354</tt>
      </p>
      <p>
        <tt>4 0.02119298  4 0.4631192 0.7935807 0.10263968</tt>
      </p>
      <p>
        <tt>5 0.01976403  5 0.4419263 0.8081870 0.10968343</tt>
      </p>
      <p>
        <tt>6 0.01109040  6 0.4221622 0.8148225 0.11010401</tt>
      </p>
      <p>
        <tt>7 0.01000000  7 0.4110718 0.8056429 0.10706531</tt>
      </p>
      <p>
        <tt></tt>
      </p>
      <p>A set of models is presented, each with an increasing number of splits to the data.  For each of the models, the relative error is equal to (1 – explained variability), which is analogous to 1 – R2 for an ANOVA model. Here, the results for three models are shown, corresponding to 0, 1, and 2 splits. The relative errors are presented in a way that scales the error for the first node to approximately 1. All subsequent errors in this column are presented relative to 1.0. Hence models can be compared relatively. The <i>xerror</i> represents a cross-validation error and <i>xstd</i> represents the corresponding standard error.</p>
      <p>The process by which the tree is estimated is detailed in the rest of the output.</p>
      <p></p>
      <p>
        <tt>Node number 1: 125 observations,  complexity param=0.3528475</tt>
      </p>
      <p>
        <tt> mean=14.5336, MSE=10.21594 </tt>
      </p>
      <p>
        <tt> left son=2 (52 obs) right son=3 (73 obs)</tt>
      </p>
      <p>
        <tt> Primary splits:</tt>
      </p>
      <p>
        <tt> elev.ut &lt; 1589.999 to the right, improve=0.35284750, (0 missing)</tt>
      </p>
      <p>
        <tt> area  &lt; 3.313698 to the left,  improve=0.17794890, (0 missing)</tt>
      </p>
      <p>
        <tt> lat  &lt; 45.297  to the right, improve=0.03301643, (0 missing)</tt>
      </p>
      <p>
        <tt> Surrogate splits:</tt>
      </p>
      <p>
        <tt> area &lt; 3.218943 to the left,  agree=0.624, adj=0.096, (0 split)</tt>
      </p>
      <p>
        <tt> lat  &lt; 43.86934 to the left,  agree=0.608, adj=0.058, (0 split)</tt>
      </p>
      <p>
        <tt></tt>
      </p>
      <p>For the first split, three primary splits were considered (<tt>elev.ut, area, </tt>and<tt> lat</tt>).  Splitting by <tt>elev.ut </tt>improved the model the most, so it was selected.  Each subsequent node is handled in a similar fashion (results not shown).</p>
      <p>At the end of the model output is a summary of the final tree...</p>
      <p>
        <tt></tt>
      </p>
      <p>
        <tt> 1) root 125 1276.99300 14.53360  </tt>
      </p>
      <p>
        <tt> 2) elev.ut&gt;=1589.999 52  324.19350 12.28407  </tt>
      </p>
      <p>
        <tt> 4) elev.ut&gt;=2330.5 27  143.52950 11.18730  </tt>
      </p>
      <p>
        <tt> 8) lat&gt;=44.59658 7  11.08354  9.55306 *</tt>
      </p>
      <p>
        <tt> 9) lat&lt; 44.59658 20  107.20750 11.75929 *</tt>
      </p>
      <p>
        <tt> 5) elev.ut&lt; 2330.5 25  113.10950 13.46857  </tt>
      </p>
      <p>
        <tt> 10) lat&gt;=43.57856 18  64.06762 12.99921 *</tt>
      </p>
      <p>
        <tt> 11) lat&lt; 43.57856 7  34.87951 14.67551 *</tt>
      </p>
      <p>
        <tt> 3) elev.ut&lt; 1589.999 73  502.21550 16.13601  </tt>
      </p>
      <p>
        <tt> 6) lat&gt;=45.29272 18  102.41810 14.27064 *</tt>
      </p>
      <p>
        <tt> 7) lat&lt; 45.29272 55  316.66640 16.74649  </tt>
      </p>
      <p>
        <tt> 14) area&lt; 2.94866 19  81.30672 15.04211 *</tt>
      </p>
      <p>
        <tt> 15) area&gt;=2.94866 36  151.03590 17.64603  </tt>
      </p>
      <p>
        <tt> 30) elev.ut&gt;=808.5004 17  58.33334 16.72940 *</tt>
      </p>
      <p>
        <tt> 31) elev.ut&lt; 808.5004 19  65.63930 18.46617 *</tt>
      </p>
      <p></p>
      <p>...but these results are best viewed graphically, as shown in the plot window:</p>
      <div style="text-align:center">
        <img alt="graphics3" class="frameGraphics" id="graphics37Cgraphics" src="rpart.JGR-img3.png" style="width:715.9968px;height:412.992px" />
      </div>
      <p></p>
      <p></p>
      <p></p>
      <p></p>
      <h1 id="toc3">
        <span class="SectionNumber"></span>
      </h1>
    </div>
  </body>
</html>
